<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <style>
    .select {
      border-color: #030bfc;
    }
    td {
      user-select: none;
      border: 3px solid;
    }
  </style>
  <body>
    <table>
        <thead><tr>
            <td>janvier</td>
            <td>fevrier</td>
            <td>mars</td>
            <td>avril</td>
            <td>mai</td>
            <td>juin</td>
            <td>juillet</td>
            <td>aout</td>
            <td>septembre</td>
            <td>octobre</td>
            <td>novembre</td>
            <td>decembre</td>
        </tr>
        </thead>
        <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
          <td>2</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>3</td>
      </tr>
      <tr>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
          <td>4</td>
      </tr>
      <tr>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
      </tr>
      <tr>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
          <td>6</td>
      </tr>
      <tr>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
          <td>7</td>
      </tr>
      <tr>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
          <td>8</td>
      </tr>
      <tr>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
          <td>9</td>
      </tr>
      <tr>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
          <td>10</td>
      </tr>
      <tr>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
          <td>11</td>
      </tr>
      <tr>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
          <td>12</td>
      </tr>
      <tr>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
          <td>13</td>
      </tr>
      <tr>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
          <td>14</td>
      </tr>
      <tr>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
          <td>15</td>
      </tr>
      <tr>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
          <td>16</td>
      </tr>
      <tr>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
          <td>17</td>
      </tr>
      <tr>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
          <td>18</td>
      </tr>
      <tr>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
          <td>19</td>
      </tr>
      <tr>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
          <td>20</td>
      </tr>
      <tr>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
          <td>21</td>
      </tr>
      <tr>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
          <td>22</td>
      </tr>
      <tr>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
          <td>23</td>
      </tr>
      <tr>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
          <td>24</td>
      </tr>
      <tr>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
          <td>25</td>
      </tr>
      <tr>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
          <td>26</td>
      </tr>
      <tr>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
          <td>27</td>
      </tr>
      <tr>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
          <td>28</td>
      </tr>
      <tr>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
          <td>29</td>
      </tr>
      <tr>
          <td>30</td>
          <td></td>
          <td>30</td>
          <td>30</td>
          <td>30</td>
          <td>30</td>
          <td>30</td>
          <td>30</td>
          <td>30</td>
          <td>30</td>
          <td>30</td>
          <td>30</td>
      </tr>
      <tr>
          <td>31</td>
          <td></td>
          <td>31</td>
          <td></td>
          <td>31</td>
          <td></td>
          <td>31</td>
          <td>31</td>
          <td></td>
          <td>31</td>
          <td></td>
          <td>31</td>
      </tr>
    </tbody>
    </table>
  </body>

  <script>
    let td = document.querySelectorAll("tbody td");
    let tr = document.querySelectorAll("tbody tr");
    let nbCol = tr[0].childElementCount;

    let countTotal = 0;
    for (let i = 0; i < nbCol; i++) {
      tr.forEach((e, k) => {
        let tds = e.querySelectorAll("tbody td");
        if(tds[i] && tds[i].textContent != ''){
        tds[i].dataset.id = countTotal;
        tds[i].dataset.month = i;
        countTotal++;
    }
      });
    }

    

    let val1 = 0;
    let val2 = 0;
    let isPush = false;
    let val1full;

    td.forEach((e) => {
      e.addEventListener("mousedown", (ev) => {
          if(ev.which == 1){ 
        td.forEach((e) => e.classList.remove("select"));
        val1 = e.dataset.id;
        isPush = true;
        e.classList.add("select")
    }
      });
      e.addEventListener("mousemove", () => {
        if (isPush) {
          val2 = e.dataset.id;

          td.forEach((k) => {
            k.classList.remove("select");
            if (
              parseInt(k.dataset.id) >= val1 &&
              parseInt(k.dataset.id) <= val2
            ) {
              k.classList.add("select");
            }
            else if(parseInt(k.dataset.id) <= val1 &&
            parseInt(k.dataset.id) >= val2){
                k.classList.add("select")
            }
          });
        }
    });
                  
    });

    window.addEventListener("mouseup", (ev)=>{
        
        console.log('bouton',ev.button)
    if(isPush && ev.which == 1){  
      val1full = document.querySelectorAll(".select");
      
      val1full = Array.from(val1full).sort((a, b)=>{
    return a.dataset.id - b.dataset.id
})

    var minValue = val1full[0]
    var maxValue = val1full[val1full.length-1]
    let months = ["janvier", "fevrier", "mars", "avril", "mai", "juin", "juillet", "aout", "septembre", "octobre", "novembre", "decembre"];

    if(minValue === maxValue){
        console.log(val1full)
        if(confirm("Voulez-vous ajouter une absence le "+val1full[0].textContent+" "+months[minValue.dataset.month]))
        console.log(val1full);
 
    }
    else
    if(confirm("Voulez-vous ajouter une absence du "+minValue.textContent+ " "+months[minValue.dataset.month]+" au "+maxValue.textContent+" "+months[maxValue.dataset.month]))
    console.log(val1full);

}
    isPush = false;

})


  </script>
</html>
